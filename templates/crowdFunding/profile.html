<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>بروفايل المستخدم</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
<style>
    .profile-container {
        max-width: 900px;
        margin: 30px auto;
        background-color: #fff;
        border-radius: 10px;
        box-shadow: 0 0 10px rgba(0,0,0,0.1);
        padding: 20px;
    }
    .profile-pic {
        width: 150px;
        height: 150px;
        object-fit: cover;
        border-radius: 50%;
        border: 3px solid #007bff;
    }
</style>
</head>
<body class="bg-light">

<div class="profile-container text-center">
    <h2 class="mb-4">بروفايلك الشخصي</h2>
{% if user.profile_pic %}
    <img src="{{ user.profile_pic.url }}" alt="Profile Picture" class="profile-pic mb-3">
{% else %}
    <img src="https://via.placeholder.com/150" alt="Default Profile Picture" class="profile-pic mb-3">
{% endif %}


    <h4>{{ user.first_name }} {{ user.last_name }}</h4>
    <p><strong>الإيميل:</strong> {{ user.email }}</p>
    <p><strong>رقم الموبايل:</strong> {{ user.phone }}</p>
    <p><strong>تاريخ الميلاد:</strong> {{ user.Birthdate|date:"Y-m-d" }}</p>
    <p><strong>الدولة:</strong> {{ user.country }}</p>
    <p><strong>بروفايل فيسبوك:</strong> <a href="{{ user.facebook_profile }}" target="_blank">{{ user.facebook_profile }}</a></p>

    <h5 class="mt-4">مشاريعك</h5>
    <ul class="list-group mb-4">
        {% for project in projects %}
        <li class="list-group-item">
            <strong>{{ project.title }}</strong> - {{ project.state }}
        </li>
        {% empty %}
        <li class="list-group-item">لا توجد مشاريع حتى الآن</li>
        {% endfor %}
    </ul>

    <h5>تبرعاتك</h5>
    <ul class="list-group mb-4">
        {% for donation in donations %}
        <li class="list-group-item">
            <strong>مشروع:</strong> {{ donation.project.title }} - <strong>قيمة:</strong> {{ donation.amount }}$
        </li>
        {% empty %}
        <li class="list-group-item">لا توجد تبرعات حتى الآن</li>
        {% endfor %}
    </ul>

    <h5 class="mt-4">تعديل البيانات</h5>
    <form method="post" enctype="multipart/form-data">
        {% csrf_token %}
        {{ form.as_p }}
        <button type="submit" class="btn btn-primary">تحديث البيانات</button>
        <button type="button" class="btn btn-danger" data-bs-toggle="modal" data-bs-target="#deleteModal">حذف الحساب</button>
    </form>
</div>

<!-- Modal للتأكيد على حذف الحساب -->
<div class="modal fade" id="deleteModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">حذف الحساب</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body">
        <form method="post" action="{% url 'delete_account' %}">
            {% csrf_token %}
            <p>هل أنت متأكد أنك تريد حذف حسابك؟</p>
            <input type="password" name="password" class="form-control mb-2" placeholder="أدخل كلمة المرور للتأكيد" required>
            <button type="submit" class="btn btn-danger">نعم، احذف الحساب</button>
        </form>
      </div>
    </div>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
